<!-- build time:Tue Jul 21 2020 23:41:38 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="baidu-site-verification" content="sH9RDFAfza"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta name="baidu-site-verification" content="70iCXvvDzNbH9002"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.proxy.ustclug.org/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"comoz.top",root:"/",scheme:"Mist",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="MySQL必知必会使用前必须查看《MySQL必知必会》附录了解关系表结构SQL语句由一个或多个关键词（简单英文单词）构成检索数据基本语法&#x3D;&#x3D;select&#x3D;&#x3D;语法 想选择什么，从哪里选123456789101112131415161718192021222324252627282930313233343536373839## 从一个表检索一列select prod_name ##prod_name为"><meta property="og:type" content="article"><meta property="og:title" content="MySQL必知必会"><meta property="og:url" content="http://comoz.top/2020/07/13/SQL/index.html"><meta property="og:site_name" content="COMO&#39;Blog"><meta property="og:description" content="MySQL必知必会使用前必须查看《MySQL必知必会》附录了解关系表结构SQL语句由一个或多个关键词（简单英文单词）构成检索数据基本语法&#x3D;&#x3D;select&#x3D;&#x3D;语法 想选择什么，从哪里选123456789101112131415161718192021222324252627282930313233343536373839## 从一个表检索一列select prod_name ##prod_name为"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://comoz.top/2020/07/13/SQL/ISEM/blog/source/_posts/SQL/SQL.png"><meta property="article:published_time" content="2020-07-13T06:55:53.000Z"><meta property="article:modified_time" content="2020-07-21T11:34:09.151Z"><meta property="article:author" content="COMO_ZHU"><meta property="article:tag" content="SQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://comoz.top/2020/07/13/SQL/ISEM/blog/source/_posts/SQL/SQL.png"><link rel="canonical" href="http://comoz.top/2020/07/13/SQL/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>MySQL必知必会 | COMO'Blog</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?f257c706fe2fd8318a3f8b7b3377a29e";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">COMO'Blog</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li></ul></nav></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://comoz.top/2020/07/13/SQL/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="COMO_ZHU"><meta itemprop="description" content="仅供自用"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="COMO'Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">MySQL必知必会</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-07-13 14:55:53" itemprop="dateCreated datePublished" datetime="2020-07-13T14:55:53+08:00">2020-07-13</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-07-21 19:34:09" itemprop="dateModified" datetime="2020-07-21T19:34:09+08:00">2020-07-21</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="MySQL必知必会"><a href="#MySQL必知必会" class="headerlink" title="MySQL必知必会"></a>MySQL必知必会</h1><blockquote><p>使用前必须查看《MySQL必知必会》附录了解关系表结构</p></blockquote><ul><li>SQL语句由一个或多个关键词（简单英文单词）构成</li></ul><h2 id="检索数据"><a href="#检索数据" class="headerlink" title="检索数据"></a>检索数据</h2><h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><ul><li><p>==select==</p></li><li><p>语法 想选择什么，从哪里选</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">## 从一个表检索一列</span><br><span class="line">select prod_name ##prod_name为列名</span><br><span class="line">from products;   ##products为表名</span><br><span class="line"></span><br><span class="line">## 语意从products表中选择prod_name列</span><br><span class="line">## 注意多条SQL语句由&#39;;&#39;分隔，否则会报错</span><br><span class="line">## SQL忽略空格，因此可以分行写，便于阅读调试</span><br><span class="line">## 结果未排序时，顺序无意义</span><br><span class="line">## SQL语句一般不分大小写，开发人员惯于对关键字大写，表列小写；</span><br><span class="line">## 但在编写过程中由颜色变化也很明显</span><br><span class="line"></span><br><span class="line">## 从一个表检索多列</span><br><span class="line">select prod_id,prod_name,prod_price ##列出多列，列间&#39;,&#39;分隔</span><br><span class="line">from products;</span><br><span class="line"></span><br><span class="line">## 从一个表检索所有列</span><br><span class="line">select *  ## * 为通配符，指所有</span><br><span class="line">from products;</span><br><span class="line"></span><br><span class="line">## 列值不重复</span><br><span class="line">select distinct vend_id ## distinct 只返回不同的行</span><br><span class="line">from products;  ## distinct 应用于后置所有列；应该是组合之后的唯一性吧</span><br><span class="line"></span><br><span class="line">## 限制结果行数 </span><br><span class="line">select prod_name ## limit [begin,]number</span><br><span class="line">from products ## 第一行为行0</span><br><span class="line">limit 5;</span><br><span class="line"></span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">limit 5,5; ## 从行5开始取5行</span><br><span class="line"></span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">limit 4 offset 3; ## 替代语法，从行2开始取4行</span><br><span class="line"></span><br><span class="line">##完全限定表名</span><br><span class="line">select products.prod_name ## 使用 .后缀的方式</span><br><span class="line">from crashcourse.products;## 完全限定，避免可能存在的误解（如同样列、表名）</span><br></pre></td></tr></table></figure></li><li><p>==计算字段==</p></li><li><p>转换、计算、格式化列数据 ，即列数据操作(不改变原数据)</p></li><li><p>支持别名 as</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">## 拼接  concatnate</span><br><span class="line">select Concat(vend_name,&#39;(&#39;,vend_country,&#39;)&#39;) ## vend_name(vend_country)</span><br><span class="line">from vendors</span><br><span class="line">order by vend_name;</span><br><span class="line"></span><br><span class="line">## 删除右侧空格 Rtrim()  </span><br><span class="line">select Concat(Rtrim(vend_name),&#39;(&#39;,vend_country,&#39;)&#39;) ## 删除了vend_name右边的空格</span><br><span class="line">from vendors</span><br><span class="line">order by vend_name;</span><br><span class="line">## trim() Ltrim()</span><br><span class="line"></span><br><span class="line">##别名（alias）,便于引用 as</span><br><span class="line">select Concat(Rtrim(vend_name),&#39;(&#39;,vend_country,&#39;)&#39;) as vend_title </span><br><span class="line">from vendors</span><br><span class="line">order by vend_name;</span><br><span class="line">##别名可用于重命名列名，不限于拼接字段</span><br><span class="line"></span><br><span class="line">##算术计算 + - * &#x2F;</span><br><span class="line">select prod_id,quantity,item_price,</span><br><span class="line">			quantity*item_price as expanded_price</span><br><span class="line">from orderitems </span><br><span class="line">where ordernum &#x3D; 20005;</span><br></pre></td></tr></table></figure><h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><ul><li><p>order by 子句</p></li><li><p>一般检索出的顺序是底层表中的顺序，或为添加顺序，受到更新、删除影响</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> ## 按一个列排序</span><br><span class="line">select prod_name  </span><br><span class="line">from products</span><br><span class="line">order by prod_name; ## 注意子句顺序</span><br><span class="line"></span><br><span class="line">select prod_name  </span><br><span class="line">from products</span><br><span class="line">order by prod_id; ## 用于排序的列可以任意，非展示列</span><br><span class="line"></span><br><span class="line">## 按多个列排序</span><br><span class="line">select prod_id,prod_name,prod_price  </span><br><span class="line">from products</span><br><span class="line">order by prod_id,prod_name； ##按多列排序时，排序按规定顺序进行。仅当前一个出现重复，才启用后一个排序</span><br><span class="line"></span><br><span class="line">## 排序方向  desc,asc(默认)</span><br><span class="line">select prod_name  </span><br><span class="line">from products</span><br><span class="line">order by prod_price desc;  ## descendent</span><br><span class="line"></span><br><span class="line">select prod_name  </span><br><span class="line">from products</span><br><span class="line">order by prod_price desc, prod_name; ## desc仅对直接位于前面的列起效 </span><br><span class="line"></span><br><span class="line">select prod_name  </span><br><span class="line">from products</span><br><span class="line">order by prod_price desc, prod_name</span><br><span class="line">limit 4 offset 3; ## 两子句组合，注意顺序</span><br></pre></td></tr></table></figure><h3 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h3><ol><li>where子句</li></ol><ul><li>搜索后，根据需要搜索（过滤条件 filter condition）</li></ul><ol start="2"><li>多条where语句组合, and、or</li></ol><ul><li>更强的过滤控制</li></ul><ol start="3"><li>通配符</li></ol><ul><li>构造通配符搜索模式，应对未知过滤值</li><li>谓词like 指示后跟搜索模式为通配符搜索</li><li>通配符搜索比前述搜索耗费时间长</li></ul><ol start="4"><li>正则表达式</li></ol><ul><li>匹配文本</li><li>where子句支持部分正则表达式</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">## 单条where</span><br><span class="line">## 相等搜索</span><br><span class="line">select prod_name,prod_price</span><br><span class="line">from products</span><br><span class="line">where prod_price &#x3D; 2.5; </span><br><span class="line"></span><br><span class="line">select prod_name,prod_price</span><br><span class="line">from products</span><br><span class="line">where prod_name &#x3D; &#39;fuse&#39;; ##匹配默认不分大小写; 单引号限定字符串</span><br><span class="line"></span><br><span class="line">## 不相等搜索</span><br><span class="line">select prod_name,prod_price</span><br><span class="line">from products</span><br><span class="line">where prod_price !&#x3D; 2.5;</span><br><span class="line"></span><br><span class="line">## 范围搜索</span><br><span class="line">select prod_name,prod_price</span><br><span class="line">from products</span><br><span class="line">where prod_price between 5 and 10; ## 包头尾</span><br><span class="line"></span><br><span class="line">## 空值检查</span><br><span class="line">## 表设计时可指定是否能含空值NULL(不同于不显示的0、空格、空字符串，是没有,空字段)</span><br><span class="line">select cust_id</span><br><span class="line">from customers</span><br><span class="line">where cust_email is null; ## 其他时候都不返回条件中的NULL值行</span><br></pre></td></tr></table></figure><table><thead><tr><th>where子句操作符</th><th></th></tr></thead><tbody><tr><td>=</td><td>等于</td></tr><tr><td>&lt;&gt; or !=</td><td>不等于</td></tr><tr><td>&lt;</td><td>小于</td></tr><tr><td>&lt;=</td><td>小于等于</td></tr><tr><td>&gt;</td><td>大于</td></tr><tr><td>&gt;=</td><td>大于等于</td></tr><tr><td>between</td><td>之间</td></tr><tr><td></td><td></td></tr><tr><td>not</td><td>否定之后任何条件</td></tr><tr><td>in</td><td>指定要匹配值的清单（以圆括号括起）</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">## 组合多条where</span><br><span class="line">select prod_id,prod_name,prod_price</span><br><span class="line">from products</span><br><span class="line">where vend_id &#x3D; 1003 and prod_price &lt;&#x3D; 10; ## 并</span><br><span class="line"></span><br><span class="line">select prod_id,prod_name,prod_price</span><br><span class="line">from products</span><br><span class="line">where vend_id &#x3D; 1003 or prod_price &lt;&#x3D; 10; ## 或</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 计算次序</span><br><span class="line">## () and or</span><br><span class="line">## 任何时候都应该使用()，以保证计算次序正确</span><br><span class="line">select prod_id,prod_name,prod_price</span><br><span class="line">from products</span><br><span class="line">where vend_id &#x3D; 1003 or vend_id &#x3D; 1002 and prod_price &lt;&#x3D; 10;</span><br><span class="line"></span><br><span class="line">select prod_id,prod_name,prod_price</span><br><span class="line">from products</span><br><span class="line">where (vend_id &#x3D; 1003 or vend_id &#x3D; 1002) and prod_price &lt;&#x3D; 10;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## in + () ,指定要匹配值清单，相当于多个 or</span><br><span class="line">select prod_id,prod_name,prod_price</span><br><span class="line">from products</span><br><span class="line">where vend_id in (1002,1003)  ## where vend_id &#x3D; 1003 or vend_id &#x3D; 1002</span><br><span class="line"></span><br><span class="line">## not 取反</span><br><span class="line">select prod_id,prod_name,prod_price</span><br><span class="line">from products</span><br><span class="line">where vend_id not in (1002,1003) ## 选择供应商ID非1002或1003的</span><br><span class="line">## 注意MySQL仅支持NOT对IN、BETWEEN、EXISTS取反，多数其他DBMS支持对各种条件取反</span><br></pre></td></tr></table></figure><table><thead><tr><th>通配符</th><th></th></tr></thead><tbody><tr><td>%</td><td>给定位置的0、1或多个字符（任意字符出现任意次）</td></tr><tr><td>_</td><td>给定位置的1个字符</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">## 通配符</span><br><span class="line">## % 任意字符出现任意次</span><br><span class="line">select prod_name,prod_id</span><br><span class="line">from products</span><br><span class="line">where prod_name like &#39;jet%&#39;; ## 匹配 jet 开头、后跟任意字符的prod_name</span><br><span class="line"></span><br><span class="line">select prod_name,prod_id</span><br><span class="line">from products</span><br><span class="line">where prod_name like &#39;%jet%&#39;;</span><br><span class="line"></span><br><span class="line">select prod_name,prod_id</span><br><span class="line">from products</span><br><span class="line">where prod_name like &#39;j%t&#39;; </span><br><span class="line">## 注意，如尾部有空格，则无法匹配；可将%置于尾部，或用函数去除空格</span><br><span class="line"></span><br><span class="line">## _ 给定位置的1个字符</span><br><span class="line">select prod_id,prod_name</span><br><span class="line">from products</span><br><span class="line">where prod_name like &#39;_ to anvil&#39;;</span><br></pre></td></tr></table></figure><table><thead><tr><th>正则表达式</th><th></th></tr></thead><tbody><tr><td>.</td><td>匹配任一字符</td></tr><tr><td>|</td><td>或</td></tr><tr><td>[]</td><td>匹配方括号其中任一字符</td></tr><tr><td>[0-9] [a-z]等</td><td>匹配范围</td></tr><tr><td>^</td><td>取反，置于集合开始，如[^123]</td></tr><tr><td>\\</td><td>转义，匹配特殊字符本身</td></tr><tr><td></td><td></td></tr><tr><td>重复元字符</td><td>匹配重复字符</td></tr><tr><td>*</td><td>0或多个重复</td></tr><tr><td>+</td><td>1或多个重复 {1,}</td></tr><tr><td>?</td><td>0或1个重复 {0,1}</td></tr><tr><td>{n}</td><td>指定数目重复</td></tr><tr><td>{n,}</td><td>不少于指定数目的重复</td></tr><tr><td>{n,m}</td><td>重复数目的范围（m不超过255）</td></tr><tr><td></td><td></td></tr><tr><td>定位</td><td>匹配特定位置</td></tr><tr><td>^</td><td>开头</td></tr><tr><td>$</td><td>结尾</td></tr><tr><td>[[:&lt;:]]</td><td>词头</td></tr><tr><td>[[:&gt;:]]</td><td>词尾</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">## 正则表达式</span><br><span class="line"></span><br><span class="line">## regexp 标示正则表达式</span><br><span class="line">## 单次出现</span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">where prod_name regexp &#39;1000&#39;; ## 匹配内含&#39;1000&#39;文本的prod_name</span><br><span class="line">## 类似 like &#39;%1000%&#39;</span><br><span class="line">## like 匹配整个列值，regexp 在列值内匹配</span><br><span class="line"></span><br><span class="line">## . </span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">where prod_name regexp &#39;.000&#39;; ## . 为任一字符</span><br><span class="line">## 区分大小写 regexp binary</span><br><span class="line"></span><br><span class="line">## [] 限定匹配范围</span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">where prod_name regexp &#39;[123]000&#39;; ## 匹配含1000、2000或3000</span><br><span class="line"></span><br><span class="line">## | 或</span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">where prod_name regexp &#39;1000|2000&#39;; ## 含1000或2000</span><br><span class="line">## 类似where子句中的or</span><br><span class="line"></span><br><span class="line">## ^ 取反</span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">where prod_name regexp &#39;[^123]000&#39;; ## 不含123的000</span><br><span class="line">##注意 置于集合内部的开始，否则为开头定位</span><br><span class="line"></span><br><span class="line">## 匹配范围</span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">where prod_name regexp &#39;[0-9]000&#39;</span><br><span class="line"></span><br><span class="line">## \\ 匹配特殊字符</span><br><span class="line">select vend_name</span><br><span class="line">from vendors</span><br><span class="line">where vend_name regexp&#39;\.&#39;;</span><br><span class="line"></span><br><span class="line">## 重复 </span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">where prod_name regexp &#39;\\([0-9] sticks?\\)&#39;; ## s 0或1次出现</span><br><span class="line"></span><br><span class="line">## 定位</span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">where regexp &#39;^[0-9\\.]&#39;;</span><br><span class="line"></span><br><span class="line">select prod_name</span><br><span class="line">from products</span><br><span class="line">where regexp &#39;[0-9\\.]$&#39;;</span><br></pre></td></tr></table></figure><h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3><ul><li>==group by==<ol><li>可多列分组（分组嵌套）</li><li>在最后规定分组上汇总</li><li>列必须为列或有效表达式（不可使用别名、非聚集函数）</li><li>除聚集计算，select中每个列都要在group by中给出</li><li>NULL值有组</li><li>顺序 where - group by - order by</li></ol></li><li>分组计算、呈现结果</li><li>可将多次过滤需要完成的工作一次完成</li><li>==having 过滤分组==<ul><li>适用where子句技术，如通配符、多操作符</li><li>数据分组前过滤 where</li><li>数据分组后过滤 having</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select order_num, sum(quantity*item_price) as ordertotal</span><br><span class="line">from  orderitems</span><br><span class="line">group by order_num with rollup；</span><br><span class="line">##添加汇总</span><br><span class="line">##与ifnull(c，&#39;总计&#39;)合用</span><br><span class="line"></span><br><span class="line">select order_num, sum(quantity*item_price) as ordertotal</span><br><span class="line">from  orderitems</span><br><span class="line">group by order_num</span><br><span class="line">having sum(quantity*item_price)&gt;&#x3D;50</span><br><span class="line">order by ordertotal;</span><br></pre></td></tr></table></figure><h2 id="复杂查询"><a href="#复杂查询" class="headerlink" title="复杂查询"></a>复杂查询</h2><h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><ul><li>subquery</li><li>嵌套于其他select语句中的select语句</li><li>可用于过滤、计算字段</li><li>逐渐增加子查询来建立查询</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">## 过滤 </span><br><span class="line">## 用于其他select的where子句</span><br><span class="line">select cust_name,cust_contact</span><br><span class="line">from customers</span><br><span class="line">where cust_id in (select cust_id</span><br><span class="line">                 from orders</span><br><span class="line">                 where order_num in (select order_num</span><br><span class="line">                                    from order_items</span><br><span class="line">                                    where prod_id  &#x3D; &#39;TNT2&#39;));</span><br><span class="line">                                    </span><br><span class="line">##注意 列匹配，即cust_id &#x3D; cust_id、order_num &#x3D; order_num</span><br><span class="line"></span><br><span class="line">## 计算字段</span><br><span class="line">select cust_name</span><br><span class="line">			 cust_state</span><br><span class="line">			 (select count(*)</span><br><span class="line">       from orders </span><br><span class="line">       where orders.cust_name &#x3D; customers.cust_name) as orders </span><br><span class="line">from customers</span><br><span class="line">order by cust_name;</span><br><span class="line">##使用子查询避免表联结</span><br><span class="line">##注意完全限定名</span><br><span class="line">##称相关子查询 correlated subquery</span><br></pre></td></tr></table></figure><h3 id="联结"><a href="#联结" class="headerlink" title="联结"></a>联结</h3><ul><li>关系数据库表，一类数据一张表</li><li>于一条select语句获取多张表的数据，使用联结关联表</li><li>不限制联结的表的数目，不联结不必要的表（消耗资源）</li><li>建议与子查询比较使用，当目的为从多表获取数据时</li><li>创建: 规定要联结的表及如何联结</li><li>等值联结（内部联结）<ul><li>where key = key</li><li>from inner join —- on（建议）</li></ul></li><li>自联结<ul><li>联结表为自身，同样的两个表相联结</li><li>可以替代从相同表中检索数据的子查询</li></ul></li><li>自然联结<ul><li>排除多次出现，每个列只返回1次</li><li>似乎仅仅返回表列重复问题？？</li></ul></li><li>外部联结<ul><li>包含没有关联行的那些行（区别于内部联结的等值）</li><li>[left | right] outer join</li><li>left right 指定包括其所有行的表</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">## --- where</span><br><span class="line">select vend_name,prod_name,prod_price</span><br><span class="line">from vendors,products ##要联结的表</span><br><span class="line">where vendors.vend_id &#x3D; products.vend_id ##where子句建立联结关系（等值联结&#x2F;内部联结）</span><br><span class="line">order by vend_name,prod_name;</span><br><span class="line">##注意 完全限定名的使用</span><br><span class="line">##注意 无联结条件，直接多表，返回表行相乘的笛卡尔积（叉联结）</span><br><span class="line"></span><br><span class="line">## 内部联结 inner join --- on</span><br><span class="line">select vend_name,prod_name,prod_price</span><br><span class="line">from vendors inner join products </span><br><span class="line">on vendors.vend_id &#x3D; products.vend_id </span><br><span class="line">order by vend_name,prod_name;</span><br><span class="line"></span><br><span class="line">## 多表</span><br><span class="line">select prod_name,vend_name,prod_price,quantity</span><br><span class="line">from orderitems,products,vendors</span><br><span class="line">where orderitems.prod_id &#x3D; products.prod_id</span><br><span class="line">and products.vend_id &#x3D; vendors.vend_id</span><br><span class="line">and order_num &#x3D; 20005;</span><br><span class="line">##在where子句中指定联结条件，and组合（包括非联结条件）</span><br><span class="line"></span><br><span class="line">## 表别名</span><br><span class="line">select cust_name,cust_contact</span><br><span class="line">from customers as c, orders as o, orderitems as oi</span><br><span class="line">where c.cust_id &#x3D; o.cust_id</span><br><span class="line">and oi.order_num &#x3D; o.order_num</span><br><span class="line">and prod_id &#x3D; &#39;TNT2&#39;;</span><br><span class="line"></span><br><span class="line">## 自联结</span><br><span class="line">select p1.prod_id,p1.prod_name</span><br><span class="line">from products as p1, products as p2</span><br><span class="line">where p1.vend_id &#x3D; p2.vend_id</span><br><span class="line">and p2.prod_id &#x3D; &#39;DTNTR&#39;</span><br><span class="line"></span><br><span class="line">## 自然联结</span><br><span class="line">select c.*, o.oders_num,o.order_date ## 表列不重复</span><br><span class="line">from customers as c, orders as o, orderitems as oi</span><br><span class="line">where c.cust_id &#x3D; o.cust_id</span><br><span class="line">and oi.order_num &#x3D; o.order_num</span><br><span class="line">and prod_id &#x3D; &#39;FB&#39;;</span><br><span class="line"></span><br><span class="line">## 外部联结</span><br><span class="line">select customers.cust_id , orders.order_num</span><br><span class="line">from customers left out join orders</span><br><span class="line">on customers.cust_id &#x3D; orders.cust_id;</span><br><span class="line"></span><br><span class="line">## 与聚集函数</span><br><span class="line">select customers.cust_name,</span><br><span class="line">			 customers.cust_id,</span><br><span class="line">			 count(orders.order_num) as num_id</span><br><span class="line">from customers inner join orders</span><br><span class="line">on customers.cust_id &#x3D; orders.cust_id</span><br><span class="line">group by customers.cust_id;</span><br></pre></td></tr></table></figure><h3 id="组合查询"><a href="#组合查询" class="headerlink" title="组合查询"></a>组合查询</h3><ul><li>union</li><li>情况<ul><li>单个表多个查询，按单个查询返回数据（等同于多个where子句条件）</li><li>单个查询不同表</li></ul></li><li>规则<ul><li>两条及以上select语句组成，语句间用select分隔</li><li>每个查询必须包含相同列、表达式或聚集函数</li><li>列数据类型兼容</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">select vend_id,prod_id,prod_price</span><br><span class="line">from products</span><br><span class="line">where prod_price&gt;&#x3D;5</span><br><span class="line">union</span><br><span class="line">select vend_id,prod_id,prod_price</span><br><span class="line">from products</span><br><span class="line">where vend_id in(1001,1002);</span><br><span class="line">##注意 vend_id,prod_id,prod_price</span><br><span class="line">##结果自动去重（union all 返回全部匹配行）</span><br><span class="line"></span><br><span class="line">select vend_id,prod_id,prod_price</span><br><span class="line">from products</span><br><span class="line">where prod_price&gt;&#x3D;5</span><br><span class="line">or vend_id in(1001,1002);</span><br><span class="line"></span><br><span class="line">## 排序</span><br><span class="line">select vend_id,prod_id,prod_price</span><br><span class="line">from products</span><br><span class="line">where prod_price&gt;&#x3D;5</span><br><span class="line">union</span><br><span class="line">select vend_id,prod_id,prod_price</span><br><span class="line">from products</span><br><span class="line">where vend_id in(1001,1002)</span><br><span class="line">order by vend_id,prod_price;</span><br><span class="line">##在最后一条select语句之后，且不允许多条</span><br></pre></td></tr></table></figure><h3 id="全文本搜索"><a href="#全文本搜索" class="headerlink" title="全文本搜索"></a>全文本搜索</h3><ul><li>对标 like、正则表达式</li><li>支持引擎 MyISAM</li><li>需在创建表时启用 creat table<ul><li>fulltext（column,c,….）[可指定多列]</li><li>不在导入数据时使用fulltext，可在导入后修改表 alter table</li></ul></li><li>关键函数<ul><li>Match() 指定被搜索列（需按次序传递表定义中所有索引列）</li><li>Against() 指定搜索表达式（多项搜索）</li></ul></li><li>查询扩展<ul><li>基本全文本搜索，找出匹配行，用行中有用词再进行一次全本文搜索</li><li>against(‘exp’ WITH QUERY EXPANSION)</li></ul></li><li>布尔文本搜索（boolean mode）<ul><li>全本文搜索的另外一种形式，无FULLTEXT索引也可以使用，但十分缓慢</li><li>可指定匹配词、排斥词、排列提示（布尔操作符完成）</li><li>against(‘exp’ IN BOOLEAN MODE)</li></ul></li><li>注意<ul><li>短词忽略（3以下，可设置）</li><li>非用词（stopwords)，词出现于50%以上的行自动非用（此规则不用于boolean mode）</li><li>行数少于3，全本文搜索不返回结果</li><li>忽略词中引号，don’t 索引为dont</li><li>中文、日语等不具有词分隔符（空格？）的语言不能恰当返回全文本搜索结果</li><li>仅MYISAM支持</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">select note_text</span><br><span class="line">from productnotes</span><br><span class="line">where match(note_text) against(&#39;rabbit&#39;);</span><br><span class="line"></span><br><span class="line">select note_text</span><br><span class="line">from productnotes</span><br><span class="line">where  note_text like &#39;rabbit&#39;;</span><br><span class="line">##两条语句实现相同，但全文本搜索返回文本匹配良好程度排序的数据</span><br><span class="line"></span><br><span class="line">select note_text,</span><br><span class="line">			 match(note_text) against(&#39;rabbit&#39;) as rank</span><br><span class="line">from productnotes;</span><br><span class="line">##注意 此处macth()置于select中，返回rank值，不匹配返回0，where子句正是据此过滤</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select note_text</span><br><span class="line">from productnotes</span><br><span class="line">where match(note_text) against(&#39;heavy&#39; IN BOOLEAN MODE);</span><br><span class="line"></span><br><span class="line">select note_text</span><br><span class="line">from productnotes</span><br><span class="line">where match(note_text) against(&#39;+rabbit +bait&#39; IN BOOLEAN MODE);</span><br><span class="line">##必含rabbit、bait</span><br><span class="line"></span><br><span class="line">select note_text</span><br><span class="line">from productnotes</span><br><span class="line">where match(note_text) against(&#39;rabbit bait&#39; IN BOOLEAN MODE);</span><br><span class="line">##无指定操作符，包含rabbit、bait至少一个</span><br><span class="line"></span><br><span class="line">select note_text</span><br><span class="line">from productnotes</span><br><span class="line">where match(note_text) against(&#39;&quot;rabbit bait&quot;&#39; IN BOOLEAN MODE);</span><br><span class="line">##匹配短语rabbit bait</span><br><span class="line"></span><br><span class="line">select note_text</span><br><span class="line">from productnotes</span><br><span class="line">where match(note_text) against(&#39;&gt;rabbit &lt;bait&#39; IN BOOLEAN MODE);</span><br><span class="line">##匹配两者，增加rabbit等级</span><br><span class="line"></span><br><span class="line">select note_text</span><br><span class="line">from productnotes</span><br><span class="line">where match(note_text) against(&#39;+rabbit +(&lt;bait)&#39; IN BOOLEAN MODE);</span><br><span class="line">##注意 此处括号搭配使用</span><br></pre></td></tr></table></figure><table><thead><tr><th>布尔操作符</th><th></th></tr></thead><tbody><tr><td>+</td><td>包含，该词必须存在</td></tr><tr><td>-</td><td>排除，该词必不存在</td></tr><tr><td>&gt;</td><td>包含，且增加该词等级</td></tr><tr><td>&lt;</td><td>包含，且减少该词等级</td></tr><tr><td>()</td><td>词组为子表达式，以子表达式为单位进行包含、排除、排列等</td></tr><tr><td>~</td><td>取消一词的排序值</td></tr><tr><td>*</td><td>截断操作，词尾通配符</td></tr><tr><td>“”</td><td>定义短语（区别于单个词的列表，短语为单位）</td></tr></tbody></table><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><blockquote><p>方便数据转换、处理</p></blockquote><ul><li>文本函数</li><li>数值函数</li><li>日期和时间函数</li><li>系统函数</li><li>==聚集函数==: 汇总，运行于行组上，区别单行</li></ul><table><thead><tr><th>文本函数</th><th></th></tr></thead><tbody><tr><td>Left (str,length)</td><td>返回串左边length长度的字符串</td></tr><tr><td>Right</td><td></td></tr><tr><td>Length</td><td>返回串长度</td></tr><tr><td>Locate(substr,str)</td><td>找出子串位置</td></tr><tr><td>Lower()</td><td>大小写转换</td></tr><tr><td>Upper()</td><td></td></tr><tr><td>Ltrim()</td><td>去空格</td></tr><tr><td>Rtrim()</td><td></td></tr><tr><td>soundex()</td><td>返回类似发音</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">## soundex 返回类似发音</span><br><span class="line">select cust_name,cust_contact</span><br><span class="line">from customers</span><br><span class="line">where soundex(cust_contact) &#x3D; soundex(&#39;Y Lee&#39;)</span><br></pre></td></tr></table></figure><table><thead><tr><th>时间日期处理函数</th><th></th></tr></thead><tbody><tr><td>AddDate()</td><td>增加一个日期（天、周）</td></tr><tr><td>AddTime()</td><td>增加一个时间（时、分）</td></tr><tr><td>Date_Add()</td><td></td></tr><tr><td><strong>返回</strong></td><td></td></tr><tr><td>CurDate()</td><td>返回当前日期</td></tr><tr><td>CurTime()</td><td></td></tr><tr><td>Date()</td><td>返回日期时间的日期部分（数据中存储的）</td></tr><tr><td>Time()</td><td></td></tr><tr><td>Year()</td><td></td></tr><tr><td>Hour()</td><td></td></tr><tr><td>Minute()</td><td></td></tr><tr><td>Month()</td><td></td></tr><tr><td>Second()</td><td></td></tr><tr><td>DateOfWeek()</td><td></td></tr><tr><td>Now()</td><td></td></tr><tr><td><strong>计算</strong></td><td></td></tr><tr><td>DateDiff(d1,d2)</td><td>计算日期差</td></tr><tr><td><strong>格式化</strong></td><td></td></tr><tr><td>Date_Format(d, format)</td><td>返回格式化的日期或时间串 （%Y%M%D%H%I%S）</td></tr><tr><td>Time_Format(t, format)</td><td></td></tr><tr><td>Str_To_Date</td><td>字符串转化为日期（标准格式）</td></tr><tr><td><strong>拼凑</strong></td><td></td></tr><tr><td>makedate(year,dateofyear)</td><td></td></tr><tr><td>maketime(hours,minutes,seconds)</td><td></td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">## Str_To_Date</span><br><span class="line">select str_to_date(&#39;08&#x2F;09&#x2F;2008&#39;,&#39;%d&#x2F;%m&#x2F;%y&#39;); ## 返回 2008-09-08</span><br><span class="line">##中间 &#x2F; 为原有格式</span><br><span class="line"></span><br><span class="line">## where日期时间过滤</span><br><span class="line">## 注意日期格式 YYYY-MM-DD</span><br><span class="line">select cust_name,cust_contact</span><br><span class="line">from orders</span><br><span class="line">where order_date &#x3D; &#39;2005-09-01&#39;;</span><br><span class="line"></span><br><span class="line">## datetime数据格式包含日期与时间</span><br><span class="line">select cust_name,cust_contact</span><br><span class="line">from orders</span><br><span class="line">where date(order_date) &#x3D; &#39;2005-09-01&#39;;</span><br><span class="line"></span><br><span class="line">select cust_name,cust_contact</span><br><span class="line">from orders</span><br><span class="line">where year(order_date) &#x3D; 2005 and month(order_date) &#x3D; 9;</span><br><span class="line">##注意 此处等值比较2005、9没有使用引号引起，函数返回为数值</span><br></pre></td></tr></table></figure><table><thead><tr><th>数值处理</th><th></th></tr></thead><tbody><tr><td>Abs()</td><td>返回绝对值</td></tr><tr><td>Exp()</td><td>返回指数值</td></tr><tr><td>Mod()</td><td>返回余数</td></tr><tr><td>Rand()</td><td>返回一个随机数</td></tr></tbody></table><table><thead><tr><th>Aggragate Function</th><th></th></tr></thead><tbody><tr><td>AVG()</td><td>返回某列的平均值</td></tr><tr><td>MAX()</td><td></td></tr><tr><td>MIN()</td><td></td></tr><tr><td>COUNT()</td><td>返回某列行数</td></tr><tr><td>SUM()</td><td></td></tr><tr><td></td><td></td></tr><tr><td>DISTINCT</td><td>只包含不同值（参数）</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">## avg</span><br><span class="line">select avg(prod_price) as avd_price</span><br><span class="line">from products</span><br><span class="line">where vend_id &#x3D; 1003; ## 返回1003号供货商提供所有产品的平均价格</span><br><span class="line">## 注意 一个均值一个avg()</span><br><span class="line">## 忽略NULL值行</span><br><span class="line"></span><br><span class="line">## count</span><br><span class="line">select count(*) as num_cust ##包含NULL的全部行</span><br><span class="line">from customers;</span><br><span class="line"></span><br><span class="line">select count(cust_email) as num_cust ##不包含NULL</span><br><span class="line">from customers;</span><br><span class="line"></span><br><span class="line">## sum</span><br><span class="line">select sum(item_price*quantity) as total_price  ##利用算术操作符在多列上执行聚集函数</span><br><span class="line">from orderitems</span><br><span class="line">where ordernum &#x3D; 20005;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## distinct 置于聚集函数括号内</span><br><span class="line">select avg(distinct prod_price) as avg_price ## 检索1003供货商种类产品的平均价格</span><br><span class="line">from products</span><br><span class="line">where vend_id &#x3D; 1003;</span><br><span class="line">## 注意 dis 必用于列名，不能用于计算式表达式</span><br></pre></td></tr></table></figure><h2 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h2><h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><ul><li>insert</li><li>插入完整行、行的一部分、多行、某些搜索结果</li><li>使用: 指定表名（列的列表）、新行值<ul><li>降低优先级 insert low priority into</li><li>多条insert语句列名且次序相同时，可合并语句（多个value列表，’,’分隔）[插入多行]</li></ul></li><li>插入搜索结果<ul><li>insert、select语句组合（从旧表复制数据至新表）</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">##1</span><br><span class="line">insert into customers</span><br><span class="line">value(null,</span><br><span class="line">     &#39;Pep&#39;,</span><br><span class="line">     &#39;100 main street&#39;,</span><br><span class="line">     &#39;los angles&#39;</span><br><span class="line">      &#39;ca&#39;,</span><br><span class="line">     &#39;90046&#39;,</span><br><span class="line">     &#39;usa&#39;,</span><br><span class="line">     null,</span><br><span class="line">     null);</span><br><span class="line">##insert语句一般无输出</span><br><span class="line">##列按次序给出，且每列必须有值（无值且允许空值时，null）</span><br><span class="line">##写法依赖特定次序，不安全</span><br><span class="line"></span><br><span class="line">##2.给出列的列表</span><br><span class="line">insert into customers(</span><br><span class="line">										 cust_name,</span><br><span class="line">										 cust_address,</span><br><span class="line">										 cust_city,</span><br><span class="line">										 cust_state,</span><br><span class="line">										 cust_zip,</span><br><span class="line">										 cust_country,</span><br><span class="line">										 cust_contact,</span><br><span class="line">										 cyst_email)</span><br><span class="line">value(</span><br><span class="line">     &#39;Pep&#39;,</span><br><span class="line">     &#39;100 main street&#39;,</span><br><span class="line">     &#39;los angles&#39;</span><br><span class="line">      &#39;ca&#39;,</span><br><span class="line">     &#39;90046&#39;,</span><br><span class="line">     &#39;usa&#39;,</span><br><span class="line">     null,</span><br><span class="line">     null);</span><br><span class="line">##列名、value相对应</span><br><span class="line">##应总是使用此种写法</span><br><span class="line">##此种写法可以省略部分列（列满足允许null值或给出默认值）</span><br><span class="line"></span><br><span class="line">##插入多行</span><br><span class="line">insert into customers(</span><br><span class="line">										 cust_name,</span><br><span class="line">										 cust_address,</span><br><span class="line">										 cust_city,</span><br><span class="line">										 cust_state,</span><br><span class="line">										 cust_zip,</span><br><span class="line">										 cust_country)</span><br><span class="line">value(</span><br><span class="line">     &#39;Pep1&#39;,</span><br><span class="line">     &#39;100 main street&#39;,</span><br><span class="line">     &#39;los angles&#39;</span><br><span class="line">      &#39;ca&#39;,</span><br><span class="line">     &#39;90046&#39;,</span><br><span class="line">     &#39;usa&#39;)，</span><br><span class="line">     (&#39;Pep2&#39;,</span><br><span class="line">     &#39;100 main street&#39;,</span><br><span class="line">     &#39;los angles&#39;</span><br><span class="line">      &#39;ca&#39;,</span><br><span class="line">     &#39;90046&#39;,</span><br><span class="line">     &#39;usa&#39;);</span><br><span class="line"></span><br><span class="line">##插入搜索结果</span><br><span class="line">insert into customers(</span><br><span class="line">										 cust_name,</span><br><span class="line">										 cust_address,</span><br><span class="line">										 cust_city,</span><br><span class="line">										 cust_state,</span><br><span class="line">										 cust_zip,</span><br><span class="line">										 cust_country)</span><br><span class="line">select  cust_name,</span><br><span class="line">				cust_address,</span><br><span class="line">				cust_city,</span><br><span class="line">				cust_state,</span><br><span class="line">				cust_zip,</span><br><span class="line">				cust_country				</span><br><span class="line">from custnew;</span><br><span class="line">##插入从custnew表中检索的各列</span><br><span class="line">##注意select写法，列不带括号</span><br><span class="line">##检索返回列位置匹配前定表列位置</span><br></pre></td></tr></table></figure><h3 id="更新、删除数据"><a href="#更新、删除数据" class="headerlink" title="更新、删除数据"></a>更新、删除数据</h3><ul><li><p>UPDATE</p></li><li><p>更新也是修改</p></li><li><p>使用: 表、列名并为列赋新值（set）、过滤条件（筛选行）</p></li><li><p>用途: 更新特定行、所有行</p><ul><li>ignore 忽略update中的错误，继续执行</li><li>删除列值，即更新列值为null（如果允许null）</li></ul></li><li><p>DELETE</p></li><li><p>使用: 表、过滤条件</p></li><li><p>用途: 删除特定行、所有行</p></li><li><p>注意: 维护引用完整性，不允许删除与其他表相关联的行（主键、外键）</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">##单列</span><br><span class="line">update customers## 表</span><br><span class="line">set cust_email &#x3D; &#39;elmer@fudd.com&#39;## 列名及新值</span><br><span class="line">where cust_id &#x3D; 10005;## 过滤条件</span><br><span class="line"></span><br><span class="line">##多列</span><br><span class="line">update customers</span><br><span class="line">set cust_email &#x3D; &#39;elmer@fudd.com&#39;，##逗号分隔多列</span><br><span class="line">		cust_name &#x3D; &#39;the fudds&#39;</span><br><span class="line">where cust_id &#x3D; 10005;</span><br><span class="line"></span><br><span class="line">##更新中使用子查询</span><br><span class="line">## https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_33351574&#x2F;article&#x2F;details&#x2F;90542893</span><br><span class="line">Update tab1 t</span><br><span class="line">set val1 &#x3D; 1</span><br><span class="line">where (workdate, cino) in (select workdate, cino from tab2)</span><br><span class="line"></span><br><span class="line">Update tab1 t</span><br><span class="line">Set (val1, val2) &#x3D; (select val1, val2</span><br><span class="line">from tab2</span><br><span class="line">where workdate &#x3D; t.workdate</span><br><span class="line">and cino &#x3D; t.cino);</span><br><span class="line"></span><br><span class="line">##ignore</span><br><span class="line">update ignore customers...</span><br><span class="line"></span><br><span class="line">##删除列值  null(如果允许)</span><br><span class="line">update customers</span><br><span class="line">set cust_email &#x3D; null</span><br><span class="line">where cust_id &#x3D; 10005;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## </span><br><span class="line">delete from customers</span><br><span class="line">where cust_id &#x3D; 10006;</span><br></pre></td></tr></table></figure><h3 id="创建、操纵表"><a href="#创建、操纵表" class="headerlink" title="创建、操纵表"></a>创建、操纵表</h3><ul><li>表操作，创建、更改、删除</li><li>==create table==</li><li>使用: 表名、列名及定义（逗号分隔）<ul><li>if not exists</li></ul></li><li>主键<ul><li>主键值唯一，多列为主键时，组合值唯一</li></ul></li><li>自动增量<ul><li>last_insert_id()返回最后一个自动增量值</li></ul></li><li>引擎<ul><li>innodb（支持事务处理）、myisam（支持全文本搜索）、merrory</li><li>数据库中引擎混用，多表不同引擎</li><li>外键不可跨引擎</li></ul></li><li>==ALTER TABLE==</li><li>使用: 表名、要更改的列表<ul><li>多条alter合并，逗号分隔</li></ul></li><li>==DROP TABLE== 表名 （删除整个表）</li><li>==RENAME TABLE== old表名 to new</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">create table customers if not exists ##仅在不存在时创建该表 </span><br><span class="line">(</span><br><span class="line">  cust_id int not null auto_incremnet,</span><br><span class="line">  cust_name char(50) not null ,</span><br><span class="line">  cust_city char(50) null ,</span><br><span class="line">  quantity int not null default 1,##默认值设定，常数</span><br><span class="line">  primary key (cust_id) ##主键设定 </span><br><span class="line">  )engine &#x3D;INNODB;##引擎设定</span><br><span class="line">  </span><br><span class="line">alter table vendors</span><br><span class="line">add vend_phone char(20);## 增加vend_phone列，字符串（20个字符）</span><br><span class="line"></span><br><span class="line">alter table vendors</span><br><span class="line">drop vend_phone;</span><br><span class="line"></span><br><span class="line">##外键定义</span><br><span class="line">CONSTRAINT constraint_name</span><br><span class="line">FOREIGN KEY foreign_key_name (columns)</span><br><span class="line">REFERENCES parent_table(columns)</span><br><span class="line">ON DELETE action</span><br><span class="line">ON UPDATE action</span><br><span class="line">##https:&#x2F;&#x2F;www.yiibai.com&#x2F;mysql&#x2F;foreign-key.html</span><br><span class="line">[CONSTRAINT symbol] FOREIGN KEY [id] (index_col_name, ...)</span><br><span class="line">REFERENCES tbl_name (index_col_name, ...)</span><br><span class="line">[ON DELETE &#123;RESTRICT | CASCADE | SET NULL | NO ACTION | SET DEFAULT&#125;]</span><br><span class="line">[ON UPDATE &#123;RESTRICT | CASCADE | SET NULL | NO ACTION | SET DEFAULT&#125;]</span><br><span class="line"></span><br><span class="line">alter table xiaodi drop foreign key xiaodi_ibfk_1; </span><br><span class="line">alter table xiaodi add foreign key(dage_id) references dage(id) on delete cascade on update cascade;</span><br><span class="line">##该语法可以在 CREATE TABLE 和 ALTER TABLE 时使用，如果不指定CONSTRAINT symbol，MYSQL会自动生成一个名字。</span><br><span class="line">##ON DELETE、ON UPDATE表示事件触发限制，可设参数：</span><br><span class="line">##RESTRICT（限制外表中的外键改动）</span><br><span class="line">##CASCADE（跟随外键改动）</span><br><span class="line">##SET NULL（设空值）</span><br><span class="line">##SET DEFAULT（设默认值）</span><br><span class="line">##NO ACTION（无动作，默认的）</span><br><span class="line">##http:&#x2F;&#x2F;www.cppblog.com&#x2F;wolf&#x2F;articles&#x2F;69089.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##关于key的进一步参考</span><br><span class="line">##https:&#x2F;&#x2F;www.cnblogs.com&#x2F;zjfjava&#x2F;p&#x2F;6922494.html</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">create table 括号内</th><th></th><th align="center"></th><th></th><th align="left"></th></tr></thead><tbody><tr><td align="center">列名</td><td>数据类型</td><td align="center">NULL</td><td>Defult</td><td align="left">AUTO_INCTREMENT</td></tr><tr><td align="center"></td><td>int、char、date等</td><td align="center">默认 NULL</td><td>设定默认值</td><td align="left">本列每增加一行自动增量；每表只允许一个自动增量列，且必须被索引（如主键）</td></tr><tr><td align="center">主键 primary key</td><td></td><td align="center"></td><td></td><td align="left"></td></tr><tr><td align="center">外键 foreign key</td><td></td><td align="center"></td><td></td><td align="left"></td></tr><tr><td align="center">全文本搜索 fulltext</td><td></td><td align="center"></td><td></td><td align="left"></td></tr></tbody></table><blockquote><p>参考 <a href="https://www.runoob.com/mysql/mysql-data-types.html" target="_blank" rel="noopener">菜鸟教程mysql数据类型</a></p></blockquote><h2 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h2><blockquote><p>据我的了解，封装意为将几条语句打包在一起实现特定功能，并以简单的方式调用，所谓函数调用即是。</p></blockquote><h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><blockquote><p>MySQL 的select语句层次的封装</p></blockquote><ul><li>虚拟表，不包含数据</li><li>==即只包含查询==（原文: 只包含使用时动态检索数据的查询；动态意为当前无数据；更新视图将更新基表）</li><li>用途<ul><li>重用SQL语句（尤其是复杂的；因其内含SQL语句），简化复杂SQL操作</li><li>使用表的一部分（谨慎建立复杂嵌套视图，性能消耗大）</li><li>保护数据，用户无实际访问数据的权限</li><li>更改数据格式，返回与底层表格式不同的数据</li></ul></li><li>使用<ul><li>==创建后跟表一样用== <code>from 视图</code></li><li>插叙、过滤、排序、联结（与其他表or视图）、添加更新数据（存在限制）</li><li>规则<ul><li>命名唯一、数量无限制、足够的权限、可嵌套（可包含从其他视图中检索数据的查询）</li><li>可内含<code>order by</code>，但会被使用该视图的select语句的<code>order by</code>覆盖（即末尾<code>order by</code>生效；不影响排序需求）</li><li>视图不能索引，不能有关联的触发器、默认值（不太懂）</li><li>可以与表一起用，如联结</li></ul></li><li>创建<ul><li>create view （create or replace view）</li><li>show create view</li><li>drop view</li></ul></li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">## 联结</span><br><span class="line">select cust_name,cust_contact</span><br><span class="line">from customers,orders,orderitems</span><br><span class="line">where customers.cust_id &#x3D; orders.cust_id</span><br><span class="line">and orders.order_num &#x3D; orderitems.order_num</span><br><span class="line">and prod_id &#x3D; &#39;TNT2&#39;;</span><br><span class="line">## 注意 联结表（尤其是末尾有筛选条件），从末尾开始理解更为方便易懂</span><br><span class="line">## 调整了orders.order_num、orderitems.order_num的顺序，这样就是完全的倒读（发现不换其实也是一个意思，只要倒读也没问题）</span><br><span class="line"></span><br><span class="line">create view productcustomers as</span><br><span class="line">select cust_name,cust_contact</span><br><span class="line">from customers,orders,orderitems</span><br><span class="line">where customers.cust_id &#x3D; orders.cust_id</span><br><span class="line">and orders.order_num &#x3D; orderitems.order_num;</span><br><span class="line">## 注意as</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select cust_name,cust_contact</span><br><span class="line">from productcustomers</span><br><span class="line">where prod_id &#x3D; &#39;TNT2&#39;;</span><br><span class="line">## MySQL处理时，where prod_id &#x3D; &#39;TNT2&#39;被加到视图查询的where子句中</span><br><span class="line">## 一次性编写基础SQL，根据需要重用</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 格式化</span><br><span class="line">select concat(rtrim(vend_name),&#39;(&#39;,rtrim(country),&#39;)&#39;)</span><br><span class="line">as vend_title</span><br><span class="line">from vendors</span><br><span class="line">order by vend_name;</span><br><span class="line"></span><br><span class="line">create view vendorlocation as </span><br><span class="line">select concat(rtrim(vend_name),&#39;(&#39;,rtrim(country),&#39;)&#39;)</span><br><span class="line">as vend_title</span><br><span class="line">from vendors</span><br><span class="line">order by vend_name;</span><br><span class="line"></span><br><span class="line">select *</span><br><span class="line">from vendorlocation</span><br><span class="line"></span><br><span class="line">## 过滤</span><br><span class="line">create view customermaillist as</span><br><span class="line">select cust_id, cust_name, cust_email</span><br><span class="line">from customers</span><br><span class="line">where cust_email is not null;</span><br><span class="line">##注意 从视图检索数据所用where子句将与视图内where子句自动组合</span><br><span class="line"></span><br><span class="line">select *</span><br><span class="line">from customermaillist;</span><br><span class="line"></span><br><span class="line">## 计算字段</span><br><span class="line">select prod_id,quantity,item_price,</span><br><span class="line">quantity*item_price as expanded_price</span><br><span class="line">from orderitems</span><br><span class="line">where prod_id &#x3D; 20005;</span><br><span class="line"></span><br><span class="line">create view orderitemsexpanded as</span><br><span class="line">select prod_id,quantity,item_price,</span><br><span class="line">quantity*item_price as expanded_price</span><br><span class="line">from orderitems;</span><br><span class="line">## 实现视图简化功能仅需在创建时使用同一查询语句（或含或不含where子句）</span><br><span class="line"></span><br><span class="line">select *</span><br><span class="line">from orderitemsexpanded</span><br><span class="line">where prod_id &#x3D; 20005;</span><br></pre></td></tr></table></figure><h3 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h3><blockquote><p>一条或多条MySQL语句的集合（不单是select）</p></blockquote><p><strong>用途</strong></p><ul><li>处理封装，简化操作</li><li>安全<ul><li>简化变动管理（表名、列名等），更改存储过程即可</li><li>使用同一存储过程，防止出错</li></ul></li><li>性能提高</li></ul><p><strong>使用</strong></p><ul><li><p>调用: call 存储过程名 （@参数，…）「<em>MySQL变量均以@开始</em>」</p></li><li><p>创建:</p><ul><li><p>create procedure name(arg,…) 「<em>注意参数相关设定</em>」</p><p>begin</p><p>存储过程体</p><p>end；</p></li></ul></li><li><p>删除 drop procedure [if exists] name</p></li><li><p>show create procedure name</p><ul><li>不指明将列出所有存储过程</li><li>show create procedure like ‘name’</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">creat procedure productpricing()##括号内未列出参数</span><br><span class="line">begin</span><br><span class="line">		select avg(prod_price) as priceaverage</span><br><span class="line">		from product; ##注意此处封号</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">drop procedure productpricing </span><br><span class="line">##注意 productpricing后无括号</span><br><span class="line"></span><br><span class="line">## 临时更改语句分隔符为&#39;&#x2F;&#x2F;&#39; </span><br><span class="line">delimiter &#x2F;&#x2F; ##除&#39;\&#39;反斜杠，任何字符均可</span><br><span class="line">##处理命令行运行中，过程体&#39;;&#39;与end后&#39;;&#39;之间的矛盾</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##</span><br><span class="line">creat procedure productpricing(</span><br><span class="line">out p1 decimal(8,2)## 参数需指定数据类型（与表设定一致）</span><br><span class="line">out ph decimal(8,2)## out关键字指明参数用于传出</span><br><span class="line">out pa decimal(8,2)## in、inout</span><br><span class="line">)</span><br><span class="line">begin</span><br><span class="line">		select min(prod_price)</span><br><span class="line">		into p1</span><br><span class="line">		from product;</span><br><span class="line">		select avg(prod_price) </span><br><span class="line">		into pa</span><br><span class="line">		from product; </span><br><span class="line">		select max(prod_price) </span><br><span class="line">		into pm</span><br><span class="line">		from product; </span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">call productpricing(@p1,@pa,@pm);</span><br><span class="line">## 既然是传出，为什么调用时还要写明</span><br><span class="line">## 参数数量要对应，名称需要吗？假如与定义中一致</span><br><span class="line">## 书本中写了另外的名字，按照一样的顺序</span><br><span class="line"></span><br><span class="line">select @p1,@pa,@pm;</span><br><span class="line"></span><br><span class="line">## </span><br><span class="line">create procedure ordertotal(</span><br><span class="line">in onumber int,</span><br><span class="line">out ototal decimal(8,2))</span><br><span class="line">begin</span><br><span class="line">	select sum(item_price*quantity)</span><br><span class="line">	from orderitems</span><br><span class="line">	where order_num &#x3D; onumber</span><br><span class="line">	into ototal; ##into应该写在哪里，语句结束处？上个例子不是</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">call procedure ordertotal(20005，@ototal);</span><br><span class="line">## 看来调用时所有参数必须写明，无论是否传出</span><br><span class="line"></span><br><span class="line">select @total;</span><br><span class="line"></span><br><span class="line">## 更复杂的存储过程</span><br><span class="line">见书 p171</span><br></pre></td></tr></table></figure><h3 id="游标-cursor"><a href="#游标-cursor" class="headerlink" title="游标 cursor"></a>游标 cursor</h3><blockquote><p>每次一行处理 vs 成批</p><p>封装了一些数据，类似视图</p></blockquote><ul><li>存储于服务器上的数据库查询</li><li><strong>非select语句，而是检索出来的结果集</strong>（==与视图正好相反==）</li><li><strong>select结果集，可单行处理</strong></li></ul><p>使用</p><ul><li>创建（无数据）<ul><li>declare name cursor for select语句</li></ul></li><li>打开（有数据）<ul><li>open name</li></ul></li><li>按需要取行<ul><li>fetch 指定检索数据及存储</li><li>单行处理位于fetch之后，循环结束之前（见P179）<ul><li>使用计算字段是否能替代例子中的行循环处理？？</li><li>插入数据必须行，行处理是否只在写入表的时候更有用</li><li>如果单纯想得到 t 计算字段完全可以（只要中间的布尔条件为常值）</li></ul></li></ul></li><li>关闭<ul><li>close name</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">create procedure processorders()</span><br><span class="line">begin </span><br><span class="line">	</span><br><span class="line">	declare o int ##声明局部变量</span><br><span class="line">	##局部变量声明需在定义游标、句柄之前</span><br><span class="line">	</span><br><span class="line">	declare ordernum cursor</span><br><span class="line">	for </span><br><span class="line">	select order_num from orders;</span><br><span class="line">	</span><br><span class="line">	open ordernum;</span><br><span class="line">	</span><br><span class="line">	fetch ordernum into o;</span><br><span class="line">	## 检索当前行的order_num列并存储到o</span><br><span class="line">	## 只有一行</span><br><span class="line">	</span><br><span class="line">	close ordernum;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">## </span><br><span class="line">create procedure processorders()</span><br><span class="line">begin </span><br><span class="line"></span><br><span class="line">	declare done boolen default 0;</span><br><span class="line">	declare o int;</span><br><span class="line">	</span><br><span class="line">	declare ordernum cursor</span><br><span class="line">	for </span><br><span class="line">	select order_num from orders;</span><br><span class="line">	</span><br><span class="line">	declare continue handler for SQLSTATE &#39;02000&#39; set done&#x3D;1;</span><br><span class="line">	## continue handler for SQLSTATE &#39;02000&#39; 条件</span><br><span class="line">	## set done&#x3D;1 执行</span><br><span class="line">	</span><br><span class="line">	open ordernum;</span><br><span class="line">	</span><br><span class="line">	repeat</span><br><span class="line">		fetch ordernum into o;## 检索当前行的order_num列并存储到o</span><br><span class="line">	UNTIL done end repeat;</span><br><span class="line">	## o同样只有一行</span><br><span class="line">	</span><br><span class="line">	close ordernum;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure><h3 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3><blockquote><p>响应delete、insert、update语句自动执行</p></blockquote><p><strong>注意</strong></p><ul><li>仅表支持触发器，视图不行</li><li>每表最多支持6个触发器，即3*2</li><li>一个触发器一个事件，不可与多个事件、表关联</li><li>触发器不支持call语句</li></ul><p><strong>使用</strong></p><ul><li>创建: 给出唯一触发器名（每个数据库唯一）、关联表、响应活动（三句之一）、何时（之前后）「<em>仅表支持触发器，视图不行</em>；每表最多支持6个触发器，即3*2」<ul><li>create trigger name before/after..</li><li>顺序 before失败，不执行操作，不执行after</li></ul></li><li>删除 drop trigger 「触发器不可更新」</li><li>insert触发器<ul><li>new表，访问被插入行</li><li>before insert中new值可更改（<strong>数据验证、净化</strong>；适用于update）</li></ul></li><li>delete触发器<ul><li>old表，防伪被删除行</li><li>old不可更新</li></ul></li><li>update触发器<ul><li>old表，new表</li><li>before update中new值可更改</li><li>old不可更新</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">create trigger newproduct after insert on procducts</span><br><span class="line">for each row select &#39;product added&#39;;</span><br><span class="line"></span><br><span class="line">create trigger neworder after insert on orders</span><br><span class="line">for each row </span><br><span class="line">select new.order_num;</span><br><span class="line">## for each row 以取得每次的neworder</span><br><span class="line"></span><br><span class="line">create trigger deleteorder before delete on orders</span><br><span class="line">for each row</span><br><span class="line">begin </span><br><span class="line">	insert into archive_orders(order_num,order_date,cust_id)</span><br><span class="line">	values(old.order_num,old.order_date,old.cust_id);## 数据存档</span><br><span class="line">end；</span><br><span class="line">## 使用before，避免由于after不能成功运行，delete取消</span><br><span class="line">## begin end可容纳多句SQL语句</span><br><span class="line"></span><br><span class="line">create trigger updatevendor before update on vendors</span><br><span class="line">for each row </span><br><span class="line">set new.vend_state &#x3D; upper(new.vend_state).</span><br><span class="line">##更新数据前的格式调整，数据净化</span><br></pre></td></tr></table></figure><h2 id="完"><a href="#完" class="headerlink" title="完"></a>完</h2><p>第26章往后不表</p><p><img src="/2020/07/13/SQL/ISEM/blog/source/_posts/SQL/SQL.png" alt="SQL"></p><p>(如果看不清，可以前往我的<a href="https://github.com/comozhu/comozhu.github.io.git" target="_blank" rel="noopener">Github</a>下载)</p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/SQL/" rel="tag"># SQL</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2020/07/13/%E5%8D%9A%E5%AE%A2%E5%BB%BA%E8%AE%BE%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/" rel="prev" title="博客建设问题汇总"><i class="fa fa-chevron-left"></i> 博客建设问题汇总</a></div><div class="post-nav-item"><a href="/2020/07/16/%E7%94%9F%E5%91%BD%E8%A1%A8%E4%B8%8E%E9%A2%84%E6%9C%9F%E5%AF%BF%E5%91%BD/" rel="next" title="生命表与预期寿命计算">生命表与预期寿命计算 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL必知必会"><span class="nav-number">1.</span> <span class="nav-text">MySQL必知必会</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#检索数据"><span class="nav-number">1.1.</span> <span class="nav-text">检索数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本语法"><span class="nav-number">1.1.1.</span> <span class="nav-text">基本语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#排序"><span class="nav-number">1.1.2.</span> <span class="nav-text">排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#过滤"><span class="nav-number">1.1.3.</span> <span class="nav-text">过滤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分组"><span class="nav-number">1.1.4.</span> <span class="nav-text">分组</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#复杂查询"><span class="nav-number">1.2.</span> <span class="nav-text">复杂查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#子查询"><span class="nav-number">1.2.1.</span> <span class="nav-text">子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#联结"><span class="nav-number">1.2.2.</span> <span class="nav-text">联结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组合查询"><span class="nav-number">1.2.3.</span> <span class="nav-text">组合查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#全文本搜索"><span class="nav-number">1.2.4.</span> <span class="nav-text">全文本搜索</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数"><span class="nav-number">1.3.</span> <span class="nav-text">函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据操作"><span class="nav-number">1.4.</span> <span class="nav-text">数据操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#插入数据"><span class="nav-number">1.4.1.</span> <span class="nav-text">插入数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#更新、删除数据"><span class="nav-number">1.4.2.</span> <span class="nav-text">更新、删除数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建、操纵表"><span class="nav-number">1.4.3.</span> <span class="nav-text">创建、操纵表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#封装"><span class="nav-number">1.5.</span> <span class="nav-text">封装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#视图"><span class="nav-number">1.5.1.</span> <span class="nav-text">视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#存储过程"><span class="nav-number">1.5.2.</span> <span class="nav-text">存储过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#游标-cursor"><span class="nav-number">1.5.3.</span> <span class="nav-text">游标 cursor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#触发器"><span class="nav-number">1.5.4.</span> <span class="nav-text">触发器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#完"><span class="nav-number">1.6.</span> <span class="nav-text">完</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">COMO_ZHU</p><div class="site-description" itemprop="description">仅供自用</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">33</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">4</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/comozhu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;comozhu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="/safeconcern@sina.com" title="E-Mail → safeconcern@sina.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="http://sociologist.cn/" title="http:&#x2F;&#x2F;sociologist.cn" rel="noopener" target="_blank">Sociologist</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">COMO_ZHU</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动</div></div></footer></div><script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script>!function(){var e,t,o,n,r,a=document.getElementsByTagName("link");if(0<a.length)for(i=0;i<a.length;i++)"canonical"==a[i].rel.toLowerCase()&&a[i].href&&(e=a[i].href);t=e?e.split(":")[0]:window.location.protocol.split(":")[0],e=e||window.location.href,window,n=e,r=document.referrer,/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(n)||(o="https"===String(t).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif",r?(o+="?r="+encodeURIComponent(document.referrer),n&&(o+="&l="+n)):n&&(o+="?l="+n),(new Image).src=o)}()</script></body></html><!-- rebuild by neat -->